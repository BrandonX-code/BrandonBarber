<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Barber.Maui.BrandonBarber.Pages.SeleccionBarberiaPage"
             BackgroundColor="#0E2A36">

    <ContentPage.Resources>
        <ResourceDictionary>
            <Color x:Key="PrimaryBackground">#0E2A36</Color>
            <Color x:Key="SecondaryBackground">#28475C</Color>
            <Color x:Key="TertiaryBackground">#E0F7FA</Color>
            <Color x:Key="TextPrimary">White</Color>
            <Color x:Key="TextSecondary">#A0A0A0</Color>
            <Color x:Key="AccentColor">#FF6F91</Color>

            <Style x:Key="SearchFrameStyle" TargetType="Border">
                <Setter Property="BackgroundColor" Value="{StaticResource SecondaryBackground}"/>
                <Setter Property="StrokeShape" Value="25"/>
                <Setter Property="Padding" Value="15,10"/>
            </Style>

            <Style x:Key="SearchEntryStyle" TargetType="Entry">
                <Setter Property="PlaceholderColor" Value="{StaticResource TextSecondary}"/>
                <Setter Property="TextColor" Value="{StaticResource TextPrimary}"/>
                <Setter Property="BackgroundColor" Value="Transparent"/>
                <Setter Property="FontSize" Value="16"/>
            </Style>

            <Style x:Key="BarberiaFrameStyle" TargetType="Border">
                <Setter Property="BackgroundColor" Value="{StaticResource SecondaryBackground}"/>
                <Setter Property="StrokeShape" Value="25"/>
                <Setter Property="Padding" Value="15"/>
                <Setter Property="HeightRequest" Value="150"/>
            </Style>

            <Style x:Key="TitleLabelStyle" TargetType="Label">
                <Setter Property="FontSize" Value="18"/>
                <Setter Property="FontAttributes" Value="Bold"/>
                <Setter Property="TextColor" Value="{StaticResource TextPrimary}"/>
                <Setter Property="LineBreakMode" Value="TailTruncation"/>
            </Style>

            <Style x:Key="InfoLabelStyle" TargetType="Label">
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="TextColor" Value="{StaticResource TextSecondary}"/>
                <Setter Property="LineBreakMode" Value="TailTruncation"/>
            </Style>

            <Style x:Key="ContactLabelStyle" TargetType="Label">
                <Setter Property="FontSize" Value="13"/>
                <Setter Property="TextColor" Value="{StaticResource AccentColor}"/>
                <Setter Property="LineBreakMode" Value="TailTruncation"/>
            </Style>
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid Padding="20" RowDefinitions="Auto, *">
        <Border Grid.Row="0"  Style="{StaticResource SearchFrameStyle}" Margin="0,0,0,15" StrokeThickness="0">
            <Grid ColumnDefinitions="*, Auto">
                <Entry x:Name="SearchEntry" Grid.Column="0" Placeholder="Buscar barberías" Style="{StaticResource SearchEntryStyle}" Text="{Binding SearchText}" />
                <Button Grid.Column="1" Text="✕" BackgroundColor="Transparent" TextColor="{StaticResource TextSecondary}" FontSize="18" WidthRequest="35" HeightRequest="35" Command="{Binding ClearSearchCommand}" IsVisible="{Binding HasSearchText}" />
            </Grid>
        </Border>

        <Grid Grid.Row="1">
            <ScrollView VerticalScrollBarVisibility="Never" HorizontalScrollBarVisibility="Never">
                <CollectionView VerticalScrollBarVisibility="Never" HorizontalScrollBarVisibility="Never" ItemsSource="{Binding FilteredBarberias}" SelectionMode="None" EmptyView="{Binding EmptyMessage}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Border Style="{StaticResource BarberiaFrameStyle}"  Margin="0,0,0,10" StrokeThickness="0">
                                <Border.GestureRecognizers>
                                    <TapGestureRecognizer Tapped="OnBarberiaTapped" />
                                </Border.GestureRecognizers>

                                <Grid ColumnDefinitions="80, *" ColumnSpacing="15">
                                    <Border WidthRequest="80" HeightRequest="80" StrokeShape="RoundRectangle 50" BackgroundColor="{StaticResource TertiaryBackground}" VerticalOptions="Center" HorizontalOptions="Center" StrokeThickness="0">
                                        <Image Source="{Binding LogoUrl, TargetNullValue='picture.png'}" Aspect="AspectFill">
                                        </Image>
                                    </Border>
                                    <StackLayout Grid.Column="1" Spacing="3" VerticalOptions="Center">

                                        <Label Text="{Binding Nombre}" Style="{StaticResource TitleLabelStyle}" />

                                        <Label Text="{Binding Direccion}"   Style="{StaticResource InfoLabelStyle}" MaxLines="1" />

                                        <Label Text="{Binding Telefono}"  Style="{StaticResource ContactLabelStyle}" />

                                        <Label Text="{Binding Email}" Style="{StaticResource ContactLabelStyle}" MaxLines="1" />
                                    </StackLayout>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </ScrollView>
        </Grid>
    </Grid>
</ContentPage>